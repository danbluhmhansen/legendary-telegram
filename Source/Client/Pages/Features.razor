@page "/Features"

@using BlazorApp1.Shared.Models.v1

<DataGrid TItem=Feature
	Data=@data
	TotalItems=@count
	ReadData=@OnReadData
	PageSize=10
	ShowPager
	Filterable
	Editable
	EditMode=DataGridEditMode.Popup
	CommandMode=DataGridCommandMode.ButtonRow
	PopupSize=ModalSize.Large
	RowInserting=OnRowInserting
	RowUpdating=OnRowUpdating
	RowRemoving=OnRowRemoving
	Responsive>
	<DataGridColumns>
		<DataGridCommandColumn TItem=Feature></DataGridCommandColumn>
		<DataGridColumn TItem=Feature Field=@nameof(Feature.Name) Caption=Name Editable />
		<DataGridColumn TItem=Feature
			Field=@nameof(Feature.Effects)
			Caption=Effects
			Editable
			PopupFieldColumnSize=ColumnSize.IsFull>
			<DisplayTemplate>
				@string.Join(", ", context.Effects.Select((Effect effect) => effect.Name))
			</DisplayTemplate>
			<EditTemplate>
				<DataGrid TItem=Effect
					Data=context.Item.Effects
					CommandMode=DataGridCommandMode.ButtonRow
					Editable
					Responsive
					ShowPager>
					<DataGridColumns>
						<DataGridColumn TItem=Effect Field=@nameof(Effect.Name) Caption=Name Editable />
						<DataGridColumn TItem=Effect Field=@nameof(Effect.Path) Caption=Path Editable />
						<DataGridColumn TItem=Effect Field=@nameof(Effect.Rule) Caption=Rule Editable />
					</DataGridColumns>
					<ButtonRowTemplate Context=EffectsContext>
						<Button Color=Color.Primary Clicked=EffectsContext.NewCommand.Clicked>
							@EffectsContext.NewCommand.LocalizationString
						</Button>
						<Button Color=Color.Secondary Clicked=EffectsContext.EditCommand.Clicked>
							@EffectsContext.EditCommand.LocalizationString
						</Button>
						<Button Color=Color.Danger Clicked=EffectsContext.DeleteCommand.Clicked>
							@EffectsContext.DeleteCommand.LocalizationString
						</Button>
					</ButtonRowTemplate>
				</DataGrid>
			</EditTemplate>
		</DataGridColumn>
	</DataGridColumns>
	<ButtonRowTemplate>
		<Button Color=Color.Primary Clicked=context.NewCommand.Clicked>
			@context.NewCommand.LocalizationString
		</Button>
		<Button Color=Color.Secondary Clicked=context.EditCommand.Clicked>
			@context.EditCommand.LocalizationString
		</Button>
		<Button Color=Color.Danger Clicked=context.DeleteCommand.Clicked>
			@context.DeleteCommand.LocalizationString
		</Button>
	</ButtonRowTemplate>
	<EmptyTemplate>No records...</EmptyTemplate>
	<LoadingTemplate>
		<SpinKit Type=SpinKitType.Circle Centered />
	</LoadingTemplate>
</DataGrid>
